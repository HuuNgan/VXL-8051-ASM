		ORG		0000H
		LJMP	MAIN
		ORG		000BH
		LJMP	TIMER0_XUAT_LED
		ORG		001BH
		LJMP	TIMER1_DEM_TG

		ORG		0030H
MAIN:
		MOV		IE,#10001010B
		MOV		TMOD,#00010001B
		MOV		DPTR,#0000H
		MOV		R0,#20H

		MOV		23H,#11100000B
		MOV		22H,#11010000B
		MOV		21H,#10110000B
		MOV		20H,#01110000B

		SETB	TF0


	CHECKER1:
		JB		P1.0,CHECKER2
		SJMP	START
	CHECKER2:
		JB		P1.1,CHECKER3
		SJMP	PAUSE
	CHECKER3:
		JB		P1.2,CHECKER1
		SJMP	RESET
		
		START:
		JNB		P1.0,$
		SETB	TR1
		SJMP	CHECKER2
		PAUSE:
		JNB		P1.1,$
		CPL		TR1
		SJMP	CHECKER3
		RESET:
		JNB		P1.2,$
		MOV		23H,#11100000B
		MOV		22H,#11010000B
		MOV		21H,#10110000B
		MOV		20H,#01110000B
		SJMP	CHECKER1

TIMER0_XUAT_LED:
		CLR		TR0
		MOV		TH0,#HIGH(-3000)
		MOV		TL0, #LOW(-3000)
		SETB	TR0
		MOV		A,@R0
		MOVX	@DPTR,A
		INC		R0
		CJNE	R0,#24H,SKIP
		MOV		R0,#20H
	SKIP:	
		RETI

TIMER1_DEM_TG:
		CLR		TR1
		MOV		TH1,#HIGH(-10000)
		MOV		TL1, #LOW(-10000)
		SETB	TR1

		INC		23H
		MOV		A,23H
		CJNE	A,#11101010B,EXIT
		MOV		23H,#11100000B
		INC		22H
		MOV		A,22H
		CJNE	A,#11011010B,EXIT
		MOV		22H,#11010000B
		INC		21H
		MOV		A,21H
		CJNE	A,#10111010B,EXIT
		MOV		21H,#10110000B
		INC		20H
		MOV		A,20H
		CJNE	A,#01110110B,EXIT
		MOV		20H,#01110000B
EXIT:	
		RETI
END		